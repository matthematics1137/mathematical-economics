<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demand — Cobb–Douglas</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>
<body>
  <p><a class="back" href="../index.html">← Back to Introduction</a></p>
  <h1>Cobb–Douglas Demand</h1>
  <div class="card">
    <p>
      Instant demand curves for Cobb–Douglas utility <code>u(x,y)=x^a y^{1-a}</code>. For
      income <code>M</code> and prices <code>p_x, p_y</code>, optimal demands are
      <code>x* = a M / p_x</code> and <code>y* = (1-a) M / p_y</code>.
    </p>
  </div>

  <div class="card">
    <div class="controls">
      <label>a <input id="a" type="range" min="0.1" max="0.9" step="0.05" value="0.5"></label>
      <label>M <input id="M" type="range" min="10" max="200" step="5" value="100"></label>
      <label>p_x <input id="px" type="range" min="0.5" max="5" step="0.1" value="1"></label>
      <label>p_y <input id="py" type="range" min="0.5" max="5" step="0.1" value="1"></label>
    </div>
    <canvas id="plot" width="900" height="520"></canvas>
    <p class="note">Coming soon: price offers, Engel curves, Hicksian/Marshallian comparison.</p>
  </div>

  <script>
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');
    const aEl = document.getElementById('a');
    const MEl = document.getElementById('M');
    const pxEl = document.getElementById('px');
    const pyEl = document.getElementById('py');

    function grid() {
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.strokeStyle = '#e6e6e9';
      for (let i=0;i<=9;i++) {
        const x = 50 + i*80;
        ctx.beginPath(); ctx.moveTo(x, 40); ctx.lineTo(x, 480); ctx.stroke();
        const y = 480 - i*44;
        ctx.beginPath(); ctx.moveTo(50, y); ctx.lineTo(850, y); ctx.stroke();
      }
      ctx.strokeStyle = '#000'; ctx.lineWidth = 2;
      ctx.beginPath(); ctx.moveTo(50,480); ctx.lineTo(850,480); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(50,480); ctx.lineTo(50,40); ctx.stroke();
    }

    function toPix(x,y) {
      return [50 + x*80, 480 - y*44];
    }

    function draw() {
      grid();
      const a = parseFloat(aEl.value);
      const M = parseFloat(MEl.value);
      const px = parseFloat(pxEl.value);
      const py = parseFloat(pyEl.value);
      const xStar = a*M/px;
      const yStar = (1-a)*M/py;
      // Budget line: p_x x + p_y y = M ⇒ y = (M - p_x x)/p_y
      ctx.strokeStyle = '#999'; ctx.lineWidth = 2;
      ctx.beginPath();
      for (let x=0; x<=10; x+=0.02) {
        const y = (M - px*x)/py; if (y<0) break;
        const [pxx,pyy] = toPix(x,y);
        if (x===0) ctx.moveTo(pxx,pyy); else ctx.lineTo(pxx,pyy);
      }
      ctx.stroke();

      // Optimal bundle
      ctx.fillStyle = '#0b66d6';
      const [bx,by] = toPix(xStar, yStar);
      ctx.beginPath(); ctx.arc(bx,by,5,0,2*Math.PI); ctx.fill();

      ctx.fillStyle = '#222';
      ctx.fillText(`x*=${xStar.toFixed(2)}, y*=${yStar.toFixed(2)}`, bx+10, by-10);
    }

    [aEl,MEl,pxEl,pyEl].forEach(el => el.addEventListener('input', draw));
    draw();
  </script>
</body>
</html>

